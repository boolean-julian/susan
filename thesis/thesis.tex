%!TEX option = --shell-escape
\documentclass[a4paper, 11pt]{report}
\usepackage[hidelinks]{hyperref}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{lipsum}
\usepackage[onehalfspacing]{setspace}
\usepackage[top=35mm, left=30mm, right=30mm]{geometry}
\usepackage{graphicx}
\usepackage{svg}
\usepackage{nameref}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{colortbl}
\usepackage{subcaption}
\usepackage{cleveref}
\usepackage{tikz}
\usepackage[main=ngerman]{babel}
\hypersetup{hypertexnames=false}

\usetikzlibrary{matrix}

\DeclareMathOperator{\rel}{\sim_R}
\renewcommand{\emph}[1]{\textit{#1}}
\newcommand{\mytitle}{\LARGE}
\newcommand{\titlespace}{\vspace{6em}}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}[definition]{Beispiel}
\newtheorem{theorem}[definition]{Satz}
\newtheorem{corollary}[definition]{Korollar}
\newtheorem*{remark}{Bemerkung}
\newenvironment{myAbstract}{\section*{Abstract}}{}

\begin{document}

\newgeometry{top=35mm, left=25mm, right=25mm, bottom=35mm}
\begin{titlepage}
	\begin{center}
		\begin{minipage}{.49\textwidth}
			\flushleft
			\includesvg[width=\textwidth]{assets/uni-logo}
		\end{minipage}
		\begin{minipage}{.49\textwidth}
			\flushright
			XX XXX XX\\
			YYY YYY Y
		\end{minipage}
		\begin{minipage}{.5\textwidth}
			\begin{center}
				\vspace{2cm}
				\mytitle 		{Bachelorarbeit}\\
				\normalsize 	im Studiengang \glqq Angewandte Informatik\grqq\\
				\titlespace
				\mytitle 		{SUSAN}\\
				\normalsize 	Ein Ansatz zur Strukturerkennung in Bildern\\
				
				\titlespace		Julian Lüken\\
								\texttt{julian.lueken@stud.uni-goettingen.de}\\
				\titlespace		Institut für Numerische und Angewandte Mathematik\\
				\titlespace		Bachelor und Masterarbeiten des Zentrums für angewandte Informatik an der Georg-August-Universität Göttingen
				
				\titlespace		\today
			\end{center}
		\end{minipage}
	\end{center}
\end{titlepage}

\restoregeometry
\newgeometry{left=45mm, right=45mm}
\pagestyle{empty}

%\begin{myAbstract}
%	\lipsum[1]
%\end{myAbstract}

\tableofcontents
\pagebreak
\restoregeometry
\pagestyle{headings}

\chapter{Einführung}

\chapter{Mathematische Grundlagen}
	\section{Analytische Grundlagen}
	\section{Varianzanalyse}
	\section{Bildverarbeitung}

\chapter{Der SUSAN Kantendetektor}
	\section{Der Algorithmus}
		Sei $I$ ein Eingangsbild. Um jedes Pixel im Bild wird eine Maske gelegt. Für unseren Zweck betrachten wir lediglich die Masken	
		\begin{center}
			\begin{tikzpicture}[fill=orange]
				\matrix(m)[matrix of nodes, nodes={draw, minimum size = 0.5cm}, nodes in empty cells, column sep=-\pgflinewidth,row sep=-\pgflinewidth]{
							&			&			&			&			&			&			\\
							&			&			&			&			&			&			\\
							&			&|[fill]|	&|[fill]|	&|[fill]|	&			&			\\
							&			&|[fill]|	&|[fill=yellow]|	&|[fill]|	&			&			\\
							&			&|[fill]|	&|[fill]|	&|[fill]|	&			&			\\
							&			&			&			&			&			&			\\
							&			&			&			&			&			&			\\
				};
			\end{tikzpicture}\qquad
			\begin{tikzpicture}[fill=orange]
				\matrix(m)[matrix of nodes, nodes={draw, minimum size = 0.5cm}, nodes in empty cells, column sep=-\pgflinewidth,row sep=-\pgflinewidth]{
							&			&|[fill]|	&|[fill]|	&|[fill]|	&			&			\\
							&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&			\\
				|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	\\
				|[fill]|	&|[fill]|	&|[fill]|	&|[fill=yellow]|	&|[fill]|	&|[fill]|	&|[fill]|	\\
				|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	\\
							&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&|[fill]|	&			\\
							&			&|[fill]|	&|[fill]|	&|[fill]|	&			&			\\
				};
			\end{tikzpicture}
		\end{center}
		wobei das gelbe Pixel der Mittelpunkt der Maske ist, die orangenen Pixel in der Maske und die weißen Pixel außerhalb der Maske liegen. 
		
		Das SUSAN-Prinzip funktioniert wie folgt:
		Für jedes Pixel $r_0$ in $I$ (wobei $I(r_0)$ der Grauwert am Pixel $r_0$ ist), berechne die Antwort
			$$A(r_0) = \text{max}\{0, g - n(r_0)\}.$$
		Dabei ist $n$ definiert als
			$$n(r_0) = \sum_r c_t(r, r_0),$$
		wobei $r$ die Pixel in der respektiven Maske sind und	
			$$
				c_t(r, r_0) =
					\text{exp}\bigg(-\Big(\frac{I(r) - I(r_0)}{t}\Big)^6\bigg)
			$$
		eine Vergleichsfunktion für zwei Pixel ist. Statt der obigen Vergleichsfunktion kann auch die Definition
			$$
				c_t(r, r_0) =
					\begin{cases}
						1 	& \text{falls } |I(r) - I(r_0)| \leq t 	\\
						0 	& \text{sonst}
					\end{cases}
			$$
		verwendet werden.
		Ein Ausschnitt der Antwort könnte etwa so aussehen:
		\begin{center}
			\begin{tikzpicture}[fill=gray]
				\matrix(m)[matrix of nodes, nodes={draw, minimum size = 0.5cm}, nodes in empty cells, column sep=-\pgflinewidth,row sep=-\pgflinewidth]{
								|[fill=black]|			&|[fill]|	&			&|[fill]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill]|	&			&|[fill]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill]|	&			&|[fill]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill]|	&			&|[fill]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill]|	&			&|[fill]|	&|[fill=black]|			\\
				};
			\end{tikzpicture}
		\end{center}
		Die Kante ist in diesem Beispiel noch nicht genau lokalisiert. Um die Kante genauer zu lokalisieren, verwenden wir das Prinzip der Non-Maximum-Suppression, bei der nur die maximale Antwort entlang einer Kante erhalten bleibt. Das Ziel ist es also, folgende Antwort aus der oberen zu isolieren.
		\begin{center}
			\begin{tikzpicture}[fill=gray]
				\matrix(m)[matrix of nodes, nodes={draw, minimum size = 0.5cm}, nodes in empty cells, column sep=-\pgflinewidth,row sep=-\pgflinewidth]{
								|[fill=black]|			&|[fill=black]|	&			&|[fill=black]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill=black]|	&			&|[fill=black]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill=black]|	&			&|[fill=black]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill=black]|	&			&|[fill=black]|	&|[fill=black]|			\\
								|[fill=black]|			&|[fill=black]|	&			&|[fill=black]|	&|[fill=black]|			\\
				};
			\end{tikzpicture}
		\end{center}
		Zu diesem Zweck wird die Richtung eines jeden Pixels $r_0 = (x_0, y_0)$ durch folgende Fallunterscheidung geprüft:
		\begin{enumerate}
			\item \textbf{Inter-Pixel:}

			\noindent Falls die Größe der USAN die des Maskendurchmessers übersteigt und die Distanz zwischen $\text{COG}(r_0)$ und $r_0$ größer als 1 Pixel ist, so ist die Richtung $D(r_0)$ gegeben durch
			$$ D(r_0) = \begin{cases}
				\text{arctan}\bigg(
					\frac{x_0 - \text{COG}(x_0)}
					{y_0 - \text{COG}(y_0)}
				\bigg) & \text{falls } \text{COG}(y_0) \neq y_0 \\
				
				\frac{\pi}{2} & \text{sonst}

			\end{cases}, $$
			wobei
			$$ \text{COG}(r_0) := \frac	{\sum_r r\,c(r,r_0)}	{\sum_r c(r,r_0)}. $$
			\item \textbf{Intra-Pixel:}
			
			\noindent Andernfalls müssen wir die zweiten Momente der USAN folgendermaßen berechnen:
			\begin{eqnarray*}
				d_{x_0} &:=& \sum_r (x-x_0)^2 \, c_t(r,r_0) \\
				d_{y_0} &:=& \sum_r (y-y_0)^2 \, c_t(r,r_0) \\
				\sigma 	&:=& \text{sgn}\bigg(\sum_r (x-x_0) \, (y-y_0) \, c_t(r,r_0)\bigg)
			\end{eqnarray*}
			Dabei ergibt sich die Richtung als
			$$ D(r_0) = \begin{cases}
					\sigma \, \text{arctan} \, \frac{d_{y_0}}{d_{x_0}} 	&	\text{falls } d_{x_0} \neq 0 \\ 
					\frac{\pi}{2}										&	\text{sonst}
				\end{cases}$$
			Falls allerdings $d_{x_0} = 0$, so ist $D(r_0) = \frac{\pi}{2}$
		\end{enumerate}



\end{document}
